<!DOCTYPE html>
<html>
  <head>
    <title>sean's pastebin uploader</title>
    <meta name="viewport" content="width=device-width">
    <style type="text/css" media="screen">
      body {
        height: 85vh;
      }
      body {
        display: flex;
        flex-direction: column;
        align-content: space-between;
        height: 70vh;
        margin: auto;
        text-align: center;
      }
      #encrypted-select {
        width: 50px;
        margin: auto;
      }
      form {
        padding: 2em;
      }
      textarea {
        font-size: 1.2em;
      }
      textarea, input {
        margin-bottom: 1em;
      }
      @media (min-width: 600px) {
        textarea {
          width: 50%;
        }
      }
      @media (prefers-color-scheme: dark) {
        body {
          background-color: black;
          color: white;
        }
      }
    </style>
    <script>
      window.onload = () => {
        let encryption;
        let hidePlaintext = () => {
          [...document.getElementsByClassName('plaintext')].map((el) => { el.style.display='none'; } )
        }
        let showEncryption = () => {
          [...document.getElementsByClassName('encrypted')].map((el) => { el.style.display='block'; } )
        }
        let hideEncryption = () => {
          [...document.getElementsByClassName('encrypted')].map((el) => { el.style.display='none'; } )
        }
        let showPlaintext = () => {
          [...document.getElementsByClassName('plaintext')].map((el) => { el.style.display='block'; } )
        }
        hideEncryption();
        document.getElementById('encrypted-select').onchange
          = () => {
            encryption = document.getElementById('encrypted-select').value;
            if (encryption === 'on') {
              hidePlaintext();
              showEncryption();
            } else {
              hideEncryption();
              showPlaintext();
            }
          };
        document.getElementById('plaintext-form').addEventListener('paste', (e) => {
          const file = e.clipboardData.items[0].getAsFile();
          if (file) {
            const formdata = new FormData();
            formdata.append('upload', file);
            fetch('https://pastebin.seanbehan.ca/', {
              method: "POST",
              body: formdata
            }).then((response) => {
              window.location = response.url;
            }); 
          }
        });
      }
    </script>
  </head>
  <body>
    <h1>Sean's Pastebin</h1>
    <p>After uploading you will be redirected to yourfile.txt. Make sure to
    save the link if you're encrypting. You can change .txt to any valid MIME
    type to display it in the browser.</p>
    <code>curl -Ls -o /dev/null -w %{url_effective} -F upload=@- https://pastebin.seanbehan.ca</code>
    <code>curl -Ls -o /dev/null -w %{url_effective} -F upload=@- https://pastebin.seanbehan.ca/encrypt</code>
    <p>encryption: </p>
    <select name="encrypted" id="encrypted-select">
      <option value="off">off</option>
      <option value="on">on</option>
    </select>
    <h2 class="plaintext">plain text</h2>
    <form id="plaintext-form" class="plaintext" method="post" enctype="multipart/form-data">
      <div>
        <textarea name="paste" rows="20" cols="30" id="paste"></textarea>
      </div>
      <button>submit</button>
    <h2 class="plaintext">plain file</h2>
    </form>
    <form class="plaintext" method="post" enctype="multipart/form-data">
      <div>
        <input id="plaintext-file-select" type="file" id="upload" name="upload">
      </div>
      <button>submit</button>
    </form>
    <h2 class="encrypted">encrypted text</h2>
    <form class="encrypted" method="post" action="./encrypt" enctype="multipart/form-data">
      <div>
        <textarea name="paste" rows="20" cols="30" id="paste"></textarea>
      </div>
      <button>submit</button>
    </form>
    <h2 class="encrypted">encrypted file</h2>
    <form class="encrypted" method="post" action="./encrypt" enctype="multipart/form-data">
      <div>
        <input type="file" id="upload" name="upload">
      </div>
      <button>submit</button>
    </form>
  </body>
  <footer>
    <a href="https://github.com/codebam/pastebin-worker">source code</a>
  </footer>
</html>
